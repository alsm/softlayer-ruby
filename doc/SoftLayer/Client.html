<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>class SoftLayer::Client - softlayer_api gem 3.2.2</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../";
  var index_rel_prefix = "../";
</script>

<script src="../js/jquery.js"></script>
<script src="../js/darkfish.js"></script>

<link href="../css/fonts.css" rel="stylesheet">
<link href="../css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../table_of_contents.html#pages">Pages</a>
    <a href="../table_of_contents.html#classes">Classes</a>
    <a href="../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    <div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  
  <p class="link"><a href="../Object.html">Object</a>
  
</div>

    
    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-c-default_client">::default_client</a>
    
    <li ><a href="#method-c-default_client-3D">::default_client=</a>
    
    <li ><a href="#method-c-new">::new</a>
    
    <li ><a href="#method-c-with_password">::with_password</a>
    
    <li ><a href="#method-i-5B-5D">#[]</a>
    
    <li ><a href="#method-i-authentication_headers">#authentication_headers</a>
    
    <li ><a href="#method-i-key_based-3F">#key_based?</a>
    
    <li ><a href="#method-i-service_named">#service_named</a>
    
    <li ><a href="#method-i-token_based-3F">#token_based?</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-SoftLayer::Client">
  <h1 id="class-SoftLayer::Client" class="class">
    class SoftLayer::Client
  </h1>

  <section class="description">
    
<p>A client is responsible for storing authentication information for API
calls and it serves as a central repository for the <a
href="Service.html">Service</a> instances that call into the network API.</p>

<p>When you create a client, you pass in hash arguments specifying how the
client should access the <a href="../SoftLayer.html">SoftLayer</a> API.</p>

<p>The following symbols are the keys for options you pass to the constructor:</p>
<ul><li>
<p><code>:username</code> - a non-empty string providing the username to use
for requests to the client</p>
</li><li>
<p><code>:api_key</code> - a non-empty string providing the api key to use for
requests to the client</p>
</li><li>
<p><code>:endpoint_url</code> - a non-empty string providing the endpoint URL
to use for requests to the client</p>
</li></ul>

<p>If any of these are missing then the <a href="Client.html">Client</a> class
will look to the <a href="Config.html">SoftLayer::Config</a> class to
provide the missing information.  Please see that class for details.</p>

  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    
    <section class="attribute-method-details" class="method-section">
      <header>
        <h3>Attributes</h3>
      </header>

      
      <div id="attribute-i-api_key" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">api_key</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>An API key passed as part of the authentication of each request. Cannot be
empty or nil.</p>
        
        </div>
      </div>
      
      <div id="attribute-i-endpoint_url" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">endpoint_url</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>The base URL for requests that are passed to the server. Cannot be empty or
nil.</p>
        
        </div>
      </div>
      
      <div id="attribute-i-network_timeout" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">network_timeout</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>An integer value (in seconds). The number of seconds to wait for HTTP
requests to the network API until they timeout. This value can be nil in
which case the timeout will be the default value for the library handling
network communication (often 30 seconds)</p>
        
        </div>
      </div>
      
      <div id="attribute-i-user_agent" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">user_agent</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>A string passed as the value for the User-Agent header when requests are
sent to <a href="../SoftLayer.html">SoftLayer</a> API.</p>
        
        </div>
      </div>
      
      <div id="attribute-i-username" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">username</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>A username passed as authentication for each request. Cannot be empty or
nil.</p>
        
        </div>
      </div>
      
    </section>
    

    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

    
      <div id="method-c-default_client" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">default_client</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>:attr_accessor:  The client class can maintain a single instance of <a
href="Client.html">Client</a> as the “default client” Other parts of the
library that accept a client as part of their calling sequence will look
for the default client if one is not provided in the call</p>

<p>This routine returns the client set as the default client.  It can be nil</p>
          
          

          
          <div class="method-source-code" id="default_client-source">
            <pre><span class="ruby-comment"># File lib/softlayer/Client.rb, line 53</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">default_client</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">@@default_client</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-default_client-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">default_client=</span><span
            class="method-args">(new_default)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="default_client-3D-source">
            <pre><span class="ruby-comment"># File lib/softlayer/Client.rb, line 57</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">default_client=</span>(<span class="ruby-identifier">new_default</span>)
  <span class="ruby-identifier">@@default_client</span> = <span class="ruby-identifier">new_default</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(options = {})</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Clients are built with a number of settings:</p>
<ul><li>
<p><strong><code>:username</code></strong> - The username of the account you
wish to access through the API</p>
</li><li>
<p><strong><code>:api_key</code></strong> - The API key used to authenticate
the user with the API</p>
</li><li>
<p><strong><code>:endpoint_url</code></strong> - The API endpoint the client
should connect to.  This defaults to API_PUBLIC_ENDPOINT</p>
</li><li>
<p><strong><code>:user_agent</code></strong> - A string that is passed along
as the user agent when the client sends requests to the server</p>
</li><li>
<p><strong><code>:timeout</code></strong> - An integer number of seconds to
wait until network requests time out.  Corresponds to the <a
href="Client.html#attribute-i-network_timeout">#network_timeout</a>
property of the client</p>
</li></ul>

<p>If these arguments are not provided then the client will try to locate them
using other sources including global variables, and the <a
href="../SoftLayer.html">SoftLayer</a> config file (if one exists)</p>
          
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/softlayer/Client.rb, line 99</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">options</span> = {})
  <span class="ruby-ivar">@services</span> = { }

  <span class="ruby-identifier">settings</span> = <span class="ruby-constant">Config</span>.<span class="ruby-identifier">client_settings</span>(<span class="ruby-identifier">options</span>)

  <span class="ruby-comment"># pick up the username from the options, the global, or assume no username</span>
  <span class="ruby-ivar">@username</span> = <span class="ruby-identifier">settings</span>[<span class="ruby-value">:username</span>]

  <span class="ruby-comment"># do a similar thing for the api key</span>
  <span class="ruby-ivar">@api_key</span> = <span class="ruby-identifier">settings</span>[<span class="ruby-value">:api_key</span>]

  <span class="ruby-comment"># grab token pair</span>
  <span class="ruby-ivar">@userId</span> = <span class="ruby-identifier">settings</span>[<span class="ruby-value">:userId</span>]
  <span class="ruby-ivar">@authToken</span> = <span class="ruby-identifier">settings</span>[<span class="ruby-value">:authToken</span>]

  <span class="ruby-comment"># and the endpoint url</span>
  <span class="ruby-ivar">@endpoint_url</span> = <span class="ruby-identifier">settings</span>[<span class="ruby-value">:endpoint_url</span>] <span class="ruby-operator">||</span> <span class="ruby-constant">API_PUBLIC_ENDPOINT</span>

  <span class="ruby-comment"># set the user agent to the one provided, or set it to a default one</span>
  <span class="ruby-ivar">@user_agent</span> = <span class="ruby-identifier">settings</span>[<span class="ruby-value">:user_agent</span>] <span class="ruby-operator">||</span> <span class="ruby-node">&quot;softlayer_api gem/#{SoftLayer::VERSION} (Ruby #{RUBY_PLATFORM}/#{RUBY_VERSION})&quot;</span>

  <span class="ruby-comment"># and assign a time out if the settings offer one</span>
  <span class="ruby-ivar">@network_timeout</span> = <span class="ruby-identifier">settings</span>[<span class="ruby-value">:timeout</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">settings</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:timeout</span>)

  <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;A SoftLayer Client requires an endpoint URL&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@endpoint_url</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@endpoint_url</span>.<span class="ruby-identifier">empty?</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-with_password" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">with_password</span><span
            class="method-args">(options = {})</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>This will be using your username and password to get a portal token with
which to authenticate client calls. This is a wrapper around <a
href="Client.html#method-c-new">::new</a>. You can pass it the same
parameters as with <a href="Client.html#method-c-new">::new</a>, with the
exception that this will be expecting a password in the options hash.</p>
          
          

          
          <div class="method-source-code" id="with_password-source">
            <pre><span class="ruby-comment"># File lib/softlayer/Client.rb, line 67</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">with_password</span>(<span class="ruby-identifier">options</span> = {})
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:username</span>].<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:username</span>].<span class="ruby-identifier">empty?</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-string">&#39;A username is required to create this client&#39;</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:password</span>].<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:password</span>].<span class="ruby-identifier">empty?</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-string">&#39;A password is required to create this client&#39;</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">service</span> = <span class="ruby-constant">SoftLayer</span><span class="ruby-operator">::</span><span class="ruby-constant">Service</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;SoftLayer_User_Customer&#39;</span>)
  <span class="ruby-identifier">token</span> = <span class="ruby-identifier">service</span>.<span class="ruby-identifier">getPortalLoginToken</span>(
    <span class="ruby-identifier">options</span>[<span class="ruby-value">:username</span>], <span class="ruby-identifier">options</span>[<span class="ruby-value">:password</span>]
  )

  <span class="ruby-identifier">options</span>[<span class="ruby-value">:userId</span>] = <span class="ruby-identifier">token</span>[<span class="ruby-string">&#39;userId&#39;</span>]
  <span class="ruby-identifier">options</span>[<span class="ruby-value">:authToken</span>] = <span class="ruby-identifier">token</span>[<span class="ruby-string">&#39;hash&#39;</span>]

  <span class="ruby-constant">SoftLayer</span><span class="ruby-operator">::</span><span class="ruby-constant">Client</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">options</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-5B-5D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">[]</span><span
            class="method-args">(service_name)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="5B-5D-source">
            <pre><span class="ruby-comment"># File lib/softlayer/Client.rb, line 190</span>
<span class="ruby-keyword">def</span> <span class="ruby-operator">[]</span>(<span class="ruby-identifier">service_name</span>)
  <span class="ruby-identifier">service_named</span>(<span class="ruby-identifier">service_name</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-authentication_headers" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">authentication_headers</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>return a hash of the authentication headers for the client</p>
          
          

          
          <div class="method-source-code" id="authentication_headers-source">
            <pre><span class="ruby-comment"># File lib/softlayer/Client.rb, line 137</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">authentication_headers</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">token_based?</span>
    {
      <span class="ruby-string">&#39;authenticate&#39;</span> =<span class="ruby-operator">&gt;</span> {
        <span class="ruby-string">&#39;complexType&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;PortalLoginToken&#39;</span>,
        <span class="ruby-string">&#39;userId&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@userId</span>,
        <span class="ruby-string">&#39;authToken&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@authToken</span>
      }
    }
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">key_based?</span>
    {
      <span class="ruby-string">&#39;authenticate&#39;</span> =<span class="ruby-operator">&gt;</span> {
        <span class="ruby-string">&#39;username&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@username</span>,
        <span class="ruby-string">&#39;apiKey&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@api_key</span>
      }
    }
  <span class="ruby-keyword">else</span>
    {}
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-key_based-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">key_based?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>return whether this client is using api_key-based authentication</p>
          
          

          
          <div class="method-source-code" id="key_based-3F-source">
            <pre><span class="ruby-comment"># File lib/softlayer/Client.rb, line 132</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">key_based?</span>
  <span class="ruby-ivar">@username</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@username</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@api_key</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@api_key</span>.<span class="ruby-identifier">empty?</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-service_named" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">service_named</span><span
            class="method-args">(service_name, service_options = {})</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns a service with the given name.</p>

<p>If a service has already been created by this client that same service will
be returned each time it is called for by name. Otherwise the system will
try to construct a new service object and return that.</p>

<p>If the service has to be created then the service_options will be passed
along to the creative function. However, when returning a previously
created <a href="Service.html">Service</a>, the service_options will be
ignored.</p>

<p>If the service_name provided does not start with &#39;SoftLayer_&#39; that
prefix will be added</p>
          
          

          
          <div class="method-source-code" id="service_named-source">
            <pre><span class="ruby-comment"># File lib/softlayer/Client.rb, line 170</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">service_named</span>(<span class="ruby-identifier">service_name</span>, <span class="ruby-identifier">service_options</span> = {})
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>,<span class="ruby-string">&quot;Please provide a service name&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">service_name</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">service_name</span>.<span class="ruby-identifier">empty?</span>

  <span class="ruby-comment"># Strip whitespace from service_name and ensure that it starts with &quot;SoftLayer_&quot;.</span>
  <span class="ruby-comment"># If it does not, then add the prefix.</span>
  <span class="ruby-identifier">full_name</span> = <span class="ruby-identifier">service_name</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">strip</span>
  <span class="ruby-keyword">if</span> <span class="ruby-keyword">not</span> <span class="ruby-identifier">full_name</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/\ASoftLayer_/</span>
    <span class="ruby-identifier">full_name</span> = <span class="ruby-node">&quot;SoftLayer_#{service_name}&quot;</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># if we&#39;ve already created this service, just return it</span>
  <span class="ruby-comment"># otherwise create a new service</span>
  <span class="ruby-identifier">service_key</span> = <span class="ruby-identifier">full_name</span>.<span class="ruby-identifier">to_sym</span>
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@services</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">service_key</span>)
    <span class="ruby-ivar">@services</span>[<span class="ruby-identifier">service_key</span>] = <span class="ruby-constant">SoftLayer</span><span class="ruby-operator">::</span><span class="ruby-constant">Service</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">full_name</span>, {<span class="ruby-value">:client</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>}.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">service_options</span>))
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@services</span>[<span class="ruby-identifier">service_key</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-token_based-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">token_based?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>return whether this client is using token-based authentication</p>
          
          

          
          <div class="method-source-code" id="token_based-3F-source">
            <pre><span class="ruby-comment"># File lib/softlayer/Client.rb, line 127</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">token_based?</span>
  <span class="ruby-ivar">@userId</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@authToken</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@authToken</span>.<span class="ruby-identifier">empty?</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://rdoc.github.io/rdoc">RDoc</a> 5.1.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

