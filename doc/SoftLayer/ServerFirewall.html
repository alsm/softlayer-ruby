<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>class SoftLayer::ServerFirewall - softlayer_api gem 3.2.2</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../";
  var index_rel_prefix = "../";
</script>

<script src="../js/jquery.js"></script>
<script src="../js/darkfish.js"></script>

<link href="../css/fonts.css" rel="stylesheet">
<link href="../css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../table_of_contents.html#pages">Pages</a>
    <a href="../table_of_contents.html#classes">Classes</a>
    <a href="../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    <div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  
  <p class="link"><a href="ModelBase.html">SoftLayer::ModelBase</a>
  
</div>

    <div id="includes-section" class="nav-section">
  <h3>Included Modules</h3>

  <ul class="link-list">
  
  
    <li><a class="include" href="DynamicAttribute.html">SoftLayer::DynamicAttribute</a>
  
  
  </ul>
</div>

    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-c-find_firewalls">::find_firewalls</a>
    
    <li class="calls-super" ><a href="#method-c-new">::new</a>
    
    <li ><a href="#method-i-cancel-21">#cancel!</a>
    
    <li ><a href="#method-i-change_rules-21">#change_rules!</a>
    
    <li ><a href="#method-i-change_rules_bypass-21">#change_rules_bypass!</a>
    
    <li ><a href="#method-i-protected_server">#protected_server</a>
    
    <li ><a href="#method-i-rules">#rules</a>
    
    <li ><a href="#method-i-service">#service</a>
    
    <li ><a href="#method-i-softlayer_properties">#softlayer_properties</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-SoftLayer::ServerFirewall">
  <h1 id="class-SoftLayer::ServerFirewall" class="class">
    class SoftLayer::ServerFirewall
  </h1>

  <section class="description">
    
<p>The <a href="ServerFirewall.html">ServerFirewall</a> class represents a
firewall in the <a href="../SoftLayer.html">SoftLayer</a> environment that
exists in a 1 to 1 relationship with a particular server (either Bare Metal
or Virtual).</p>

<p>This is also called a “Shared Firewall” in some documentation.</p>

<p>Instances of this class roughly correspond to instances of the
SoftLayer_Network_Component_Firewall service entity.</p>

  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    
    <section class="attribute-method-details" class="method-section">
      <header>
        <h3>Attributes</h3>
      </header>

      
      <div id="attribute-i-status" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">status</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>The state of the firewall, includes whether or not the rules are editable
and whether or not the firewall rules are applied or bypassed Can at least
be &#39;allow_edit&#39;, &#39;bypass&#39; or &#39;no_edit&#39;. This list
may not be exhaustive</p>
        
        </div>
      </div>
      
    </section>
    

    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

    
      <div id="method-c-find_firewalls" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">find_firewalls</span><span
            class="method-args">(client = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Locate and return all the server firewalls in the environment.</p>

<p>These are a bit tricky to track down. The strategy we take here is to look
at the account and find all the VLANs that do NOT have their
“dedicatedFirewallFlag” set.</p>

<p>With the list of VLANs in hand we check each to see if it has an
firewallNetworkComponents (corresponding to bare metal servers) or
firewallGuestNetworkComponents (corresponding to virtual servers) that have
a status of “allow_edit”. Each such component is a firewall interface on
the VLAN with rules that the customer can edit.</p>

<p>The collection of all those VLANs becomes the set of firewalls for the
account.</p>
          
          

          
          <div class="method-source-code" id="find_firewalls-source">
            <pre><span class="ruby-comment"># File lib/softlayer/ServerFirewall.rb, line 199</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">find_firewalls</span>(<span class="ruby-identifier">client</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">softlayer_client</span> = <span class="ruby-identifier">client</span> <span class="ruby-operator">||</span> <span class="ruby-constant">Client</span>.<span class="ruby-identifier">default_client</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;#{__method__} requires a client but none was given and Client::default_client is not set&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">softlayer_client</span>

  <span class="ruby-comment"># Note that the dedicatedFirewallFlag is actually an integer and not a boolean</span>
  <span class="ruby-comment"># so we compare it against 0</span>
  <span class="ruby-identifier">shared_vlans_filter</span> = <span class="ruby-constant">SoftLayer</span><span class="ruby-operator">::</span><span class="ruby-constant">ObjectFilter</span>.<span class="ruby-identifier">new</span>() { <span class="ruby-operator">|</span><span class="ruby-identifier">filter</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">filter</span>.<span class="ruby-identifier">accept</span>(<span class="ruby-string">&quot;networkVlans.dedicatedFirewallFlag&quot;</span>).<span class="ruby-identifier">when_it</span> <span class="ruby-identifier">is</span>(<span class="ruby-value">0</span>)
  }

  <span class="ruby-identifier">bare_metal_firewalls_data</span> = []
  <span class="ruby-identifier">virtual_firewalls_data</span> = []

  <span class="ruby-identifier">shared_vlans</span> = <span class="ruby-identifier">softlayer_client</span>[<span class="ruby-value">:Account</span>].<span class="ruby-identifier">object_mask</span>(<span class="ruby-identifier">network_vlan_mask</span>).<span class="ruby-identifier">object_filter</span>(<span class="ruby-identifier">shared_vlans_filter</span>).<span class="ruby-identifier">getNetworkVlans</span>
  <span class="ruby-identifier">shared_vlans</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">vlan_data</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">bare_metal_firewalls_data</span>.<span class="ruby-identifier">concat</span> <span class="ruby-identifier">vlan_data</span>[<span class="ruby-string">&#39;firewallNetworkComponents&#39;</span>].<span class="ruby-identifier">select</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">network_component</span><span class="ruby-operator">|</span> <span class="ruby-identifier">network_component</span>[<span class="ruby-string">&#39;status&#39;</span>] <span class="ruby-operator">!=</span> <span class="ruby-string">&#39;no_edit&#39;</span>}
    <span class="ruby-identifier">virtual_firewalls_data</span>.<span class="ruby-identifier">concat</span> <span class="ruby-identifier">vlan_data</span>[<span class="ruby-string">&#39;firewallGuestNetworkComponents&#39;</span>].<span class="ruby-identifier">select</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">network_component</span><span class="ruby-operator">|</span> <span class="ruby-identifier">network_component</span>[<span class="ruby-string">&#39;status&#39;</span>] <span class="ruby-operator">!=</span> <span class="ruby-string">&#39;no_edit&#39;</span>}
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">bare_metal_firewalls</span> = <span class="ruby-identifier">bare_metal_firewalls_data</span>.<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">bare_metal_firewall_data</span><span class="ruby-operator">|</span>
    <span class="ruby-constant">ServerFirewall</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">softlayer_client</span>, <span class="ruby-identifier">bare_metal_firewall_data</span>)
  }

  <span class="ruby-identifier">virtual_server_firewalls</span> = <span class="ruby-identifier">virtual_firewalls_data</span>.<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">virtual_firewall_data</span><span class="ruby-operator">|</span>
    <span class="ruby-constant">ServerFirewall</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">softlayer_client</span>, <span class="ruby-identifier">virtual_firewall_data</span>)
  }

  <span class="ruby-keyword">return</span> <span class="ruby-identifier">bare_metal_firewalls</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">virtual_server_firewalls</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(client, network_hash)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Calls super to initialize the object then initializes some properties</p>
          
          
            <div class="method-calls-super">
              Calls superclass method
              <a href="ModelBase.html#method-c-new">SoftLayer::ModelBase.new</a>
            </div>
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/softlayer/ServerFirewall.rb, line 85</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">client</span>, <span class="ruby-identifier">network_hash</span>)
  <span class="ruby-keyword">super</span>(<span class="ruby-identifier">client</span>, <span class="ruby-identifier">network_hash</span>)
  <span class="ruby-ivar">@protected_server</span> = <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-cancel-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">cancel!</span><span
            class="method-args">(notes = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Cancel the firewall</p>

<p>This method cancels the firewall and releases its resources. The
cancellation is processed immediately! Call this method with careful
deliberation!</p>

<p>Notes is a string that describes the reason for the cancellation. If empty
or nil, a default string will be added</p>
          
          

          
          <div class="method-source-code" id="cancel-21-source">
            <pre><span class="ruby-comment"># File lib/softlayer/ServerFirewall.rb, line 101</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">cancel!</span>(<span class="ruby-identifier">notes</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">user</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">softlayer_client</span>[<span class="ruby-value">:Account</span>].<span class="ruby-identifier">object_mask</span>(<span class="ruby-string">&quot;mask[id,account]&quot;</span>).<span class="ruby-identifier">getCurrentUser</span>
  <span class="ruby-identifier">notes</span> = <span class="ruby-node">&quot;Cancelled by a call to #{__method__} in the softlayer_api gem&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">notes</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">nil</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">notes</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;&quot;</span>

  <span class="ruby-identifier">cancellation_request</span> = {
    <span class="ruby-string">&#39;accountId&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">user</span>[<span class="ruby-string">&#39;account&#39;</span>][<span class="ruby-string">&#39;id&#39;</span>],
    <span class="ruby-string">&#39;userId&#39;</span>    =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">user</span>[<span class="ruby-string">&#39;id&#39;</span>],
    <span class="ruby-string">&#39;items&#39;</span> =<span class="ruby-operator">&gt;</span> [ {
      <span class="ruby-string">&#39;billingItemId&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>[<span class="ruby-string">&#39;billingItem&#39;</span>][<span class="ruby-string">&#39;id&#39;</span>],
      <span class="ruby-string">&#39;immediateCancellationFlag&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>
      } ],
    <span class="ruby-string">&#39;notes&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">notes</span>
  }

  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">softlayer_client</span>[<span class="ruby-value">:Billing_Item_Cancellation_Request</span>].<span class="ruby-identifier">createObject</span>(<span class="ruby-identifier">cancellation_request</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-change_rules-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">change_rules!</span><span
            class="method-args">(rules_data)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Change the set of rules for the firewall. The rules_data parameter should
be an array of hashes where each hash gives the conditions of the rule. The
keys of the hashes should be entries from the array returned by
SoftLayer::ServerFirewall.default_rules_mask_keys</p>

<p><strong>NOTE!</strong> When changing the rules on the firewall, you must
pass in a complete set of rules each time. The rules you submit will
replace the entire ruleset on the destination firewall.</p>

<p><strong>NOTE!</strong> The rules themselves have an “orderValue” property.
It is this property, and <strong>not</strong> the order that the rules are
found in the rules_data array, which will determine in which order the
firewall applies it&#39;s rules to incoming traffic.</p>

<p><strong>NOTE!</strong> Changes to the rules are not applied immediately on
the server side. Instead, they are enqueued by the firewall update service
and updated periodically. A typical update will take about one minute to
apply, but times may vary depending on the system load and other
circumstances.</p>
          
          

          
          <div class="method-source-code" id="change_rules-21-source">
            <pre><span class="ruby-comment"># File lib/softlayer/ServerFirewall.rb, line 140</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">change_rules!</span>(<span class="ruby-identifier">rules_data</span>)
  <span class="ruby-identifier">change_object</span> = {
    <span class="ruby-string">&quot;networkComponentFirewallId&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">id</span>,
    <span class="ruby-string">&quot;rules&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">rules_data</span>
  }

  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">softlayer_client</span>[<span class="ruby-value">:Network_Firewall_Update_Request</span>].<span class="ruby-identifier">createObject</span>(<span class="ruby-identifier">change_object</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-change_rules_bypass-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">change_rules_bypass!</span><span
            class="method-args">(bypass_symbol)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>This method asks the firewall to ignore its rule set and pass all traffic
through the firewall. Compare the behavior of this routine with
change_routing_bypass!</p>

<p>It is important to note that changing the bypass to :bypass_firewall_rules
removes ALL the protection offered by the firewall. This routine should be
used with careful deliberation.</p>

<p>Note that this routine queues a rule change and rule changes may take time
to process. The change will probably not take effect immediately.</p>

<p>The two symbols accepted as arguments by this routine are:
:apply_firewall_rules - The rules of the firewall are applied to traffic.
This is the default operating mode of the firewall :bypass_firewall_rules -
The rules of the firewall are ignored. In this configuration the firewall
provides no protection.</p>
          
          

          
          <div class="method-source-code" id="change_rules_bypass-21-source">
            <pre><span class="ruby-comment"># File lib/softlayer/ServerFirewall.rb, line 165</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">change_rules_bypass!</span>(<span class="ruby-identifier">bypass_symbol</span>)
  <span class="ruby-identifier">change_object</span> = {
    <span class="ruby-string">&quot;networkComponentFirewallId&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">id</span>,
    <span class="ruby-string">&quot;rules&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">rules</span>
  }

  <span class="ruby-keyword">case</span> <span class="ruby-identifier">bypass_symbol</span>
  <span class="ruby-keyword">when</span> <span class="ruby-value">:apply_firewall_rules</span>
    <span class="ruby-identifier">change_object</span>[<span class="ruby-string">&#39;bypassFlag&#39;</span>] = <span class="ruby-keyword">false</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">softlayer_client</span>[<span class="ruby-value">:Network_Firewall_Update_Request</span>].<span class="ruby-identifier">createObject</span>(<span class="ruby-identifier">change_object</span>)
  <span class="ruby-keyword">when</span> <span class="ruby-value">:bypass_firewall_rules</span>
    <span class="ruby-identifier">change_object</span>[<span class="ruby-string">&#39;bypassFlag&#39;</span>] = <span class="ruby-keyword">true</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">softlayer_client</span>[<span class="ruby-value">:Network_Firewall_Update_Request</span>].<span class="ruby-identifier">createObject</span>(<span class="ruby-identifier">change_object</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-node">&quot;An invalid parameter was sent to #{__method__}. It accepts :apply_firewall_rules and :bypass_firewall_rules&quot;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-protected_server" class="method-detail ">
        
        
        <div class="method-heading">
          <span class="method-callseq">
            protected_server(force_update=false)
          </span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        
        

        <div class="method-description">
          
          <p>Retrieve the server that this firewall is attached to. The result may be
either a bare metal or virtual server.</p>
          
          

          
          <div class="method-source-code" id="protected_server-source">
            <pre><span class="ruby-comment"># File lib/softlayer/ServerFirewall.rb, line 64</span>
<span class="ruby-identifier">sl_dynamic_attr</span> <span class="ruby-value">:protected_server</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">protected_server</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">protected_server</span>.<span class="ruby-identifier">should_update?</span> <span class="ruby-keyword">do</span>
    <span class="ruby-ivar">@protected_server</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">protected_server</span>.<span class="ruby-identifier">to_update</span> <span class="ruby-keyword">do</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">has_sl_property?</span>(<span class="ruby-string">&#39;networkComponent&#39;</span>)
      <span class="ruby-ivar">@protected_server</span> = <span class="ruby-constant">SoftLayer</span><span class="ruby-operator">::</span><span class="ruby-constant">BareMetalServer</span>.<span class="ruby-identifier">server_with_id</span>(<span class="ruby-keyword">self</span>[<span class="ruby-string">&#39;networkComponent&#39;</span>][<span class="ruby-string">&#39;downlinkComponent&#39;</span>][<span class="ruby-string">&#39;hardwareId&#39;</span>], <span class="ruby-value">:client</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">softlayer_client</span>)
    <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">if</span> <span class="ruby-identifier">has_sl_property?</span>(<span class="ruby-string">&#39;guestNetworkComponent&#39;</span>)
      <span class="ruby-ivar">@protected_server</span> = <span class="ruby-constant">SoftLayer</span><span class="ruby-operator">::</span><span class="ruby-constant">VirtualServer</span>.<span class="ruby-identifier">server_with_id</span>(<span class="ruby-keyword">self</span>[<span class="ruby-string">&#39;guestNetworkComponent&#39;</span>][<span class="ruby-string">&#39;guest&#39;</span>][<span class="ruby-string">&#39;id&#39;</span>], <span class="ruby-value">:client</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">softlayer_client</span>)
    <span class="ruby-keyword">end</span>

    <span class="ruby-ivar">@protected_server</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rules" class="method-detail ">
        
        
        <div class="method-heading">
          <span class="method-callseq">
            rules(force_update=false)
          </span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        
        

        <div class="method-description">
          
          <p>Retrieve the firewall rules assigned to this firewall. These rules will be
read from the network API every time you ask for the value of this
property. To change the rules on the server use the asymmetric method
change_rules!</p>
          
          

          
          <div class="method-source-code" id="rules-source">
            <pre><span class="ruby-comment"># File lib/softlayer/ServerFirewall.rb, line 36</span>
<span class="ruby-identifier">sl_dynamic_attr</span> <span class="ruby-value">:rules</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">firewall_rules</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">firewall_rules</span>.<span class="ruby-identifier">should_update?</span> <span class="ruby-keyword">do</span>
    <span class="ruby-comment"># firewall rules update every time you ask for them.</span>
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">firewall_rules</span>.<span class="ruby-identifier">to_update</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">rules_data</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">service</span>.<span class="ruby-identifier">object_mask</span>(<span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">default_rules_mask</span>).<span class="ruby-identifier">getRules</span>()

    <span class="ruby-comment"># At the time of this writing, the object mask sent to getRules is not</span>
    <span class="ruby-comment"># applied properly. This has been reported as a bug to the proper</span>
    <span class="ruby-comment"># development team. In the mean time, this extra step does filtering</span>
    <span class="ruby-comment"># that should have been done by the object mask.</span>
    <span class="ruby-identifier">rules_keys</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">default_rules_mask_keys</span>
    <span class="ruby-identifier">new_rules</span> = <span class="ruby-identifier">rules_data</span>.<span class="ruby-identifier">inject</span>([]) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">new_rules</span>, <span class="ruby-identifier">current_rule</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">new_rule</span> = <span class="ruby-identifier">current_rule</span>.<span class="ruby-identifier">delete_if</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span> <span class="ruby-operator">!</span>(<span class="ruby-identifier">rules_keys</span>.<span class="ruby-identifier">include?</span> <span class="ruby-identifier">key</span>) }
      <span class="ruby-identifier">new_rules</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">new_rule</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">new_rules</span>.<span class="ruby-identifier">sort</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">lhs</span>, <span class="ruby-identifier">rhs</span><span class="ruby-operator">|</span> <span class="ruby-identifier">lhs</span>[<span class="ruby-string">&#39;orderValue&#39;</span>] <span class="ruby-operator">&lt;=&gt;</span> <span class="ruby-identifier">rhs</span>[<span class="ruby-string">&#39;orderValue&#39;</span>] }
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-service" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">service</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="service-source">
            <pre><span class="ruby-comment"># File lib/softlayer/ServerFirewall.rb, line 233</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">service</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">softlayer_client</span>[<span class="ruby-value">:Network_Component_Firewall</span>].<span class="ruby-identifier">object_with_id</span>(<span class="ruby-keyword">self</span>.<span class="ruby-identifier">id</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-softlayer_properties" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">softlayer_properties</span><span
            class="method-args">(object_mask = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="softlayer_properties-source">
            <pre><span class="ruby-comment"># File lib/softlayer/ServerFirewall.rb, line 237</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">softlayer_properties</span>(<span class="ruby-identifier">object_mask</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">service</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">service</span>
  <span class="ruby-identifier">service</span> = <span class="ruby-identifier">service</span>.<span class="ruby-identifier">object_mask</span>(<span class="ruby-identifier">object_mask</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">object_mask</span>

  <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">has_sl_property?</span>(<span class="ruby-string">&#39;networkComponent&#39;</span>)
    <span class="ruby-identifier">service</span>.<span class="ruby-identifier">object_mask</span>(<span class="ruby-string">&quot;mask[id,status,billingItem.id,networkComponent.downlinkComponent.hardwareId]&quot;</span>).<span class="ruby-identifier">getObject</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">service</span>.<span class="ruby-identifier">object_mask</span>(<span class="ruby-string">&quot;mask[id,status,billingItem.id,guestNetworkComponent.guest.id]&quot;</span>).<span class="ruby-identifier">getObject</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://rdoc.github.io/rdoc">RDoc</a> 5.1.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

